syntax = "proto3";

package inventory.v1;

option go_package = "github.com/utafrali/EcommerceGo/gen/go/inventory/v1;inventoryv1";

import "google/protobuf/timestamp.proto";

service InventoryService {
  rpc CheckAvailability(CheckAvailabilityRequest) returns (CheckAvailabilityResponse);
  rpc ReserveStock(ReserveStockRequest) returns (ReserveStockResponse);
  rpc ReleaseStock(ReleaseStockRequest) returns (ReleaseStockResponse);
  rpc ConfirmReservation(ConfirmReservationRequest) returns (ConfirmReservationResponse);
}

message StockLevel {
  string product_id = 1;
  string variant_id = 2;
  int32 quantity = 3;
  int32 reserved = 4;
  int32 available = 5;
  int32 low_stock_threshold = 6;
}

message CheckAvailabilityRequest {
  repeated StockCheckItem items = 1;
}

message StockCheckItem {
  string product_id = 1;
  string variant_id = 2;
  int32 quantity = 3;
}

message CheckAvailabilityResponse {
  bool all_available = 1;
  repeated StockCheckResult results = 2;
}

message StockCheckResult {
  string product_id = 1;
  string variant_id = 2;
  bool available = 3;
  int32 available_quantity = 4;
  int32 requested_quantity = 5;
}

message ReserveStockRequest {
  string checkout_id = 1;
  repeated StockCheckItem items = 2;
  int32 ttl_seconds = 3;
}

message ReserveStockResponse {
  string reservation_id = 1;
  bool success = 2;
  repeated StockCheckResult results = 3;
  google.protobuf.Timestamp expires_at = 4;
}

message ReleaseStockRequest {
  string reservation_id = 1;
}

message ReleaseStockResponse {
  bool success = 1;
}

message ConfirmReservationRequest {
  string reservation_id = 1;
}

message ConfirmReservationResponse {
  bool success = 1;
}
