{{/*
secret.yaml â€” sensitive credentials.
Base64-encoded placeholder values are provided here so `helm template` succeeds
out of the box. Replace them with real values via --set or an external secret
manager (e.g. Vault, Sealed Secrets, External Secrets Operator).

  helm install ecommerce-go ./ecommerce-go \
    --set secrets.postgresPassword="$(echo -n 'MY_PW' | base64)" \
    --set secrets.jwtSecret="$(echo -n 'MY_JWT' | base64)"
*/}}
apiVersion: v1
kind: Secret
metadata:
  name: {{ include "ecommerce-go.fullname" . }}-secrets
  namespace: {{ .Release.Namespace }}
  labels:
    {{- include "ecommerce-go.labels" . | nindent 4 }}
  annotations:
    helm.sh/hook: pre-install,pre-upgrade
    helm.sh/hook-weight: "-5"
type: Opaque
data:
  # PostgreSQL password (base64 of "ecommerce_secret")
  POSTGRES_PASSWORD: {{ .Values.secrets.postgresPassword | default "ZWNvbW1lcmNlX3NlY3JldA==" | quote }}
  # JWT signing secret (base64 of "change-this-to-a-secure-secret-in-production")
  JWT_SECRET: {{ .Values.secrets.jwtSecret | default "Y2hhbmdlLXRoaXMtdG8tYS1zZWN1cmUtc2VjcmV0LWluLXByb2R1Y3Rpb24=" | quote }}
  # Redis password (empty by default)
  REDIS_PASSWORD: {{ .Values.secrets.redisPassword | default "" | b64enc | quote }}
  # Stripe credentials
  STRIPE_SECRET_KEY: {{ .Values.secrets.stripeSecretKey | default "c2tfdGVzdF94eHg=" | quote }}
  STRIPE_WEBHOOK_SECRET: {{ .Values.secrets.stripeWebhookSecret | default "d2hzZWNfeHh4" | quote }}
  # MinIO credentials
  MINIO_ACCESS_KEY: {{ .Values.secrets.minioAccessKey | default "bWluaW9hZG1pbg==" | quote }}
  MINIO_SECRET_KEY: {{ .Values.secrets.minioSecretKey | default "bWluaW9hZG1pbg==" | quote }}
  # SMTP credentials (empty by default)
  SMTP_USERNAME: {{ .Values.secrets.smtpUsername | default "" | b64enc | quote }}
  SMTP_PASSWORD: {{ .Values.secrets.smtpPassword | default "" | b64enc | quote }}
